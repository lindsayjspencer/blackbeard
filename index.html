<!DOCTYPE html>
<html lang="en">

<head>
    <title>Blackbeard</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <script defer src="/jquery/dist/jquery.min.js"></script>
    <link defer type="text/css" rel="stylesheet" href="/bootstrap/dist/css/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="/main.css">
    <link defer rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css" integrity="sha256-46qynGAkLSFpVbEBog43gvNhfrOj+BmwXdxFgVK/Kvc=" crossorigin="anonymous">
    <script defer src="/bootstrap/dist/js/bootstrap.min.js"></script>
    <script defer src="/tween.umd.js"></script>
    <script defer src="https://cdn.socket.io/socket.io-1.7.3.js"></script>
</head>

<body>
    <div class="game-screen d-flex flex-column align-items-center">
        <div class="main-logo mb-2 mt-auto">
            <i class="fas fa-skull fa-3x text-warning"></i>
        </div>
        <h3 class="mt-2">
            Blackbeard
        </h3>
        <div class="d-flex flex-row game-screen-options init-loading justify-content-center mt-3 w-100 text-black-50">
            <span class="loading mr-2">Loading</span>
            <span>
                <i class="fas fa-spinner fa-spin fa-fw fa-lg"></i>
            </span>
        </div>
        <div class="input-group game-screen-options hide mb-auto">
            <button class="btn btn-outline-secondary init-btn m-auto btn-block" type="button">Initiate</button>
        </div>
    </div>

    <script type="module">

        function initiateSockets() {

            const socket = io();

            socket.on('update', function(torrents) {
                console.log(torrents);
            });

            function socket_loop() {
                socket.emit('checkping', "yes")
            }

            setInterval(socket_loop, 500);

        }

        window.onload = (e) => {
            initiateSockets();
            $(".game-screen-options").toggleClass("hide");
            $("html").on("keyup", function(e) {
                if(e.keyCode == 13) {
                    $(".init-btn").click();
                }
            });
            $(".init-btn").on("click", function(){
                $("html").off("keyup");
                $(".game-screen").addClass("hide");
                setTimeout(function(){
                    $(".game-screen").remove();
                }, 600);
            });
        }


    </script>
</body>

</html>
